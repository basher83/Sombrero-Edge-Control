<!-- Infrastructure Status Badges -->
<img src="https://img.shields.io/badge/Terraform-7B42BC?style=plastic&logo=terraform&logoColor=white" alt="Terraform" />
<img src="https://img.shields.io/badge/Proxmox-E57000?style=plastic&logo=proxmox&logoColor=white" alt="Proxmox" />
<img src="https://img.shields.io/badge/Ubuntu_22.04-E95420?style=plastic&logo=ubuntu&logoColor=white" alt="Ubuntu 22.04" />

<!-- Deployment Status -->
<img src="https://img.shields.io/badge/Deployed-2025--08--31-brightgreen?style=plastic&logo=github" alt="Deployed 2025-08-31" />
<img src="https://img.shields.io/badge/Operator-basher8383-blue?style=plastic&logo=github" alt="Operator: basher8383" />

<!-- Alternative: Markdown with line breaks for very long URLs -->

![Last Commit](
https://img.shields.io/github/last-commit/basher83/Lunar-Module
?style=plastic&logo=github&display_timestamp=author
)

<!-- Alternative: Simple HTML badge (most reliable) -->
<img src="https://img.shields.io/github/last-commit/basher83/Lunar-Module?style=plastic&logo=github&display_timestamp=author" alt="Last Commit" />

<!-- Alternative: Reference-style link -->

[Last Commit Badge]: https://img.shields.io/github/last-commit/basher83/Lunar-Module?style=plastic&logo=github&display_timestamp=author

![Last Commit][Last Commit Badge]

## Deployment Metadata

- **Date**: 2025-08-31 03:33:34
- **Operator**: basher8383
- **Environment**: production
- **Target**: jump-man (192.168.10.250)

---

# Jump-Man Deployment Flight Checklist üöÄ

## Pre-Flight Checks ‚úàÔ∏è

- ‚úÖ **Environment variables loaded**: `mise env` shows TF*VAR*\* values
  - export TF_VAR_ci_ssh_key='your_key'
  - export TF_VAR_proxmox_insecure=true
  - export TF_VAR_pve_api_token='terraform@pve...'
  - export TF_VAR_pve_api_url='https://IPV4:8006/api2/json'
- ‚úÖ **Initialize Terraform**: `mise run prod-init`
  - Terraform has been successfully initialized!
- ‚úÖ **Validate configuration**: `mise run prod-validate`
  - Success! The configuration is valid.
- ‚úÖ **Review plan**: `mise run prod-plan` (verify creating 2 resources)
  - module.jump_man.proxmox_virtual_environment_file.vendor_data[0] will be created
  - module.jump_man.proxmox_virtual_environment_vm.vm will be created
- ‚úÖ **Proxmox accessible**: `ping -c 3 ${TARGET_PROXMOX_HOST}` succeeds
- ‚úÖ **Template exists**: Verify Ubuntu template ID 8000 on node lloyd

## Take-Off üõ´

- [] **Deploy infrastructure**: `mise run prod-apply`
  - module.jump_man.proxmox_virtual_environment_file.vendor_data[0]: Creating... Error: failed to open SSH client: unable to authenticate user "" over SSH to "192.168.10.2:22". Please verify that ssh-agent is correctly loaded with an authorized key via 'ssh-add -L' (NOTE: configurations in ~/.ssh/config are not considered by the provider): failed to dial 192.168.10.2:22: ssh: handshake failed: ssh: unable to authenticate, attempted methods [none], no supported methods remain
- [ ] **Monitor progress**: Watch Proxmox console for VM creation
- [ ] **Wait for cloud-init**: ~30-60 seconds for initial boot

## Post-Flight Verification ‚úÖ

- [ ] **Quick connectivity**: `mise run smoke-test-quick`
- [ ] **Full smoke tests**: `mise run smoke-test`
- [ ] **Docker check**: `mise run smoke-test-docker`
- [ ] **SSH access**: `ssh ansible@192.168.10.250`
- [ ] **Verify hostname**: Returns `jump-man`
- [ ] **Check services**: Docker running, QEMU agent active

## Emergency Procedures üÜò

### Rollback

```bash
terraform destroy -target=module.jump_man -auto-approve
```

### Debug cloud-init

```bash
ssh ansible@192.168.10.250 "sudo cloud-init status --long"
ssh ansible@192.168.10.250 "sudo journalctl -u cloud-init"
```

### Connection timeout

```bash
# Check VM status in Proxmox
qm status 7000

# Check network from Proxmox host
ping 192.168.10.250
```

## Mission Complete üéØ

- [ ] **Document IP/access**: Update team wiki/docs
- [ ] **Commit state file**: If using local backend
- [ ] **Schedule Ansible hardening**: Next phase configuration

## Pilot notes

- First attempt at apply errored: module.jump_man.proxmox_virtual_environment_file.vendor_data[0]: Creating... Error: failed to open SSH client: unable to authenticate user "" over SSH to "192.168.10.2:22". Please verify that ssh-agent is correctly loaded with an authorized key via 'ssh-add -L' (NOTE: configurations in ~/.ssh/config are not considered by the provider): failed to dial 192.168.10.2:22: ssh: handshake failed: ssh: unable to authenticate, attempted methods [none], no supported methods remain
  - RESOLUTION: Add `var.proxmox_ssh_username` and `var.proxmox_ssh_private_key` to .mise.local.toml and infrastructure/environments/production/providers.tf, infrastructure/environments/production/variables.tf
  - ROOT CAUSE: Proxmox provider needs to SSH to Proxmox target host to upload the vendor data file
- Second attempt I put the public key in .mise.local.toml instead of private key. When adding private key IDE yelled at me and kept auto formatting the file. You need triple quotes in the toml file.
  - EXAMPLE: Use triple quotes to wrap multi-line private keys in TOML files

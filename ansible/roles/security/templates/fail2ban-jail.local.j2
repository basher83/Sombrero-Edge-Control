# {{ ansible_managed }}
# Fail2ban jail configuration

[DEFAULT]
# Ban IP addresses for {{ security_fail2ban_bantime }} seconds
bantime = {{ security_fail2ban_bantime }}

# Time window for counting failures
findtime = {{ security_fail2ban_findtime }}

# Number of failures before ban
maxretry = {{ security_fail2ban_maxretry }}

# Whitelist IP addresses
ignoreip = {{ security_fail2ban_ignoreip }}

# Email for notifications
destemail = {{ security_fail2ban_destemail }}
sender = fail2ban@{{ ansible_hostname }}

# Action to take when banning
action = {{ security_fail2ban_action }}

# Use systemd for log backend if available
{% if ansible_service_mgr == "systemd" %}
backend = systemd
{% else %}
backend = auto
{% endif %}

# Chain for iptables/nftables
chain = INPUT

# Protocol
protocol = tcp

# Log encoding
logencoding = utf-8
